      PROGRAM GROIDEN
C*******************************************************************
C GROUND COOLING BY HORIZONTAL BURIED PIPES
C ATHANASSIOS ARGIRIOU, 05 - 9 - 1993
C*******************************************************************
C
      EXTERNAL FINT
      COMMON BI,SA
      CHARACTER FILIN*6,FILOUT*6
      DIMENSION TA(24)
C
C THERMOPHYSICAL PARAMETERS OF THE SOIL
      DATA DIFF/6.9E-07/,CSO/1.8/
C GEOMETRY OF THE PIPES
      DATA RAD/.125/,XL/20./
C CONFIGURATION
      DATA DEP/1.5/,TISC/7200./,FV/6./
C
      PI=4.*ATAN(1.)
C
C INPUT PARAMETERS
C
      WRITE(*,'(A)')' GIVE THE GROUND TEMPERATURE VALUE'
      READ(*,*)TG
      WRITE(*,'(A)')' ENTER THE AMBIENT TEMPERATURES FILE NAME'
      READ(*,'(A)')FILIN
      OPEN(100,FILE=FILIN)
      WRITE(*,'(A)')' ENTER THE OUTPUT FILE NAME'
      READ(*,'(A)')FILOUT
      OPEN(200,FILE=FILOUT)
C
C INITIALISATION
C
      SUR=PI*RAD**2
C HEAT PROPAGATION LIMIT
      R2P=48.*DIFF*TISC
      R2=SQRT(R2P**2/2.+2.*R2P*DEP/PI)
C
      DO 10 I=1,24
      READ(100,*)TA(I)
C
C THERMOPHYSICAL PARAMETERS OF THE AIR & HEAT TRANSFER PARAMETERS
C
      CPA=CPAIR(TA(I))
      CA=CAIR(TA(I))
      DA=DAIR(TA(I))
      DVA=DVAIR(TA(I))
C
      REY=RE(FV,2.*RAD,DA,DVA)
      PRA=PR(CPA,DVA,CA)
      CALL NEWTCO(RAD,XL,FV,DA,CA,REY,PRA,H)
C
      BI=RAD*H/CSO
      SA=2.*H*XL/DA/RAD/CPA/FV
      FO=2.*DIFF*TISC/R2/R2
C
C INTEGRATION
C
      VINT=SIMPN(0.,FO,FO/100.,FINT)
C
      U=EXP(-SA)*(1.+SQRT(BI*SA)*VINT)
C
C AIR OUTLET TEMPERATURE
C
      TO=U*(TA(I)-TG)+TG
C
C RESULTS
C
      WRITE(200,*)I,TA(I),TO,TG,U
 10   CONTINUE
      CLOSE(100)
      CLOSE(200)
      END
C
C
      SUBROUTINE NEWTCO(RAD,XL,FV,DAIR,CAIR,REY,PRA,H)
C CALCULATION OF THE HEAT TRANSFER COEFFICIENT H
      IF(REY.LT.2000.) THEN
      H=3.66+.0668*2.*RAD*REY*PRA/XL/(1.+.04*(2.*RAD/XL*REY*
     $PRA)**(2./3.))
      ELSE
      H=.023*REY**.8*PRA**.3
      ENDIF
      H=H*CAIR/2./RAD
      RETURN
      END
C
C
      FUNCTION FINT(FO)
C FUNCTION TO BE INTEGRATED
      COMMON BI,SA
      DIMENSION RI(1)
      ARG=2.*SQRT(BI*SA*FO)
      CALL I0(ARG,RIC)
      CALL INUE(ARG,1,RIC,RI)
      FINT=EXP(-BI*FO)*RI(1)*SQRT(FO)
      RETURN
      END
