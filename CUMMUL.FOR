      PROGRAM EXTRACT
C
C CALCULATES THE FREQUENCY DISTIBUTIONS FOR A SELECTED PARAMETER FROM 
C BIGAV & BIGOP FILES
C ATHANASSIOS ARGIRIOU 15-4-1993
C
      CHARACTER*6 INFIL,OUTFIL
      DIMENSION PAR(6),ICUM(9,6,42)
C
      WRITE(*,1000)
 1000 FORMAT(' ENTER INPUT FILE NAME  ')
      READ(*,1010)INFIL
 1010 FORMAT(A6)     
      WRITE(*,1100)
 1100 FORMAT(' ENTER OUTPUT FILE NAME ')
      READ(*,1010)OUTFIL
C      
      OPEN(200,FILE=OUTFIL)
      OPEN(100,FILE=INFIL)
C
      DO 100 J=1,15483
      READ(100,1210)MONTH,IDAY,IH,(PAR(I),I=1,6)
 1210 FORMAT(3I3,6F6.1) 
      DO 10 I=1,6
      IFR=INT(PAR(I)+1.)
   10 ICUM(MONTH,I,IFR)=ICUM(MONTH,I,IFR)+1
C      IFLAG=IFLAG+1
C      WRITE(*,*)IFLAG
C      GOTO 5
 100  CONTINUE
      DO 30 MONTH=6,9
      DO 30 I=1,6
      TOT=0.
C      DO 31 IFR=0,40,1
C   31 TOT=TOT+FLOAT(ICUM(MONTH,I,IFR))
C      WRITE(*,*)TOT
      DO 30 IFR=0,40,1
      RES=FLOAT(ICUM(MONTH,I,IFR))
C      WRITE(*,*)RES
   30 WRITE(200,1300)MONTH,I,IFR,RES
 1300 FORMAT(3I3,F8.2)  
      CLOSE(100)
      CLOSE(200)
      END
      
                                  
                    