      PROGRAM CLIMAKE
C**********************************************************************
C THIS PROGRAM READS THE DAT01.77 WEATHER DATA FILES OF THE IMPAE-NOA
C AND CREATES THE APPROPRIATE DATA FILES TO BE USED WITH BY THE ATHRAD
C CODE FOR CALCULATING THE NIGHT VENTILATION POTENTIAL IN ATHENS
C ATHANASSIOS A. ARGIRIOU, APRIL 7TH, 1993
C**********************************************************************
C
      CHARACTER INAMIN*8,INAMOUT*8,BIDON*72
      DIMENSION BUF(8),TA(12,31,24),RH(12,31,24),WV(12,31,24),CC(12,31)
C READS THE FILE CONTAINING THE FILE NAMES TO BE PROCESSED
      MONTH=0
      OPEN(100,FILE='FILNAMES')
      DO 5 JJ=1,12
      READ(100,1000)INAMIN
      MONTH=MONTH+1
      WRITE(*,*)MONTH
 1000 FORMAT(A8)     
      WRITE(*,*)INAMIN
C THE WEATHER DATA FILE AND THE DESTINATION FILE ARE OPENED
      OPEN(200,FILE=INAMIN)
      OPEN(300,FILE='CLM80')
C THE MONTH,THE YEAR,AND THE NO OF DAYS OF THAT MONTH ARE READ 
      READ(200,*)
      READ(200,*)NDAY
      READ(200,*)
C READS THE TEMPERATURES AND STORES THEM IN MEMORY
      DO 20 IDAY=1,NDAY
      DO 20 J=1,3
      READ(200,1100)BIDON,(BUF(K),K=1,8)
C FOR YEAR 1977
C 1100 FORMAT(A15,F7.1,7F8.1)
C FOR YEAR 1978
 1100 FORMAT(A15,8F8.1)
      DO 20 K=1,8
      IHOUR=K+8*(J-1)
   20 TA(MONTH,IDAY,IHOUR)=BUF(K)
C      WRITE(*,*)(TA(MONTH,NDAY,IHOUR),IHOUR=1,24)
C READS THE REL. HUMIDITIES AND STORES THEM IN MEMORY
      READ(200,*)
C      READ(200,*)
      DO 30 IDAY=1,NDAY
      DO 30 J=1,3
      READ(200,1100)BIDON,(BUF(K),K=1,8)
      DO 30 K=1,8
      IHOUR=K+8*(J-1)
   30 RH(MONTH,IDAY,IHOUR)=BUF(K)
C      WRITE(*,*)(RH(MONTH,NDAY,IHOUR),IHOUR=1,24)
C      PAUSE   
C READS THE WIND VELOCITY
      READ(200,*)
C      READ(200,*)
      DO 40 IDAY=1,NDAY
      DO 40 J=1,3
      READ(200,1100)BIDON,(BUF(K),K=1,8)
      DO 40 K=1,8
      IHOUR=K+8*(J-1)
  40  WV(MONTH,IDAY,IHOUR)=BUF(K)
C      WRITE(*,*)(WV(MONTH,NDAY,IHOUR),IHOUR=1,24)
C      PAUSE         
C SKIPS THE WET BULB AND INSOLATION DATA
      READ(200,*)
C      READ(200,*)
      DO 50 IDAY=1,NDAY
   50 READ(200,*)
 1200 FORMAT(A72)
C      READ(200,*)    
      DO 55 I=1,5
  55  READ(200,1200)BIDON
C READS THE CLOUD COVER DATA
      READ(200,1200)BIDON
C      READ(200,1200)BIDON
      DO 60 IDAY=1,NDAY
   60 READ(200,1300)BIDON,CC(MONTH,IDAY)
C      WRITE(*,*)CC(MONTH,NDAY)
 1300 FORMAT(A30,F8.1)
C WRITES DATA IN THE OUTPUT FILE
      WRITE(*,*)NDAY
      DO 70 IDAY=1,NDAY    
      DO 70 IHOUR=1,24
  70  WRITE(300,1400)MONTH,IDAY,TA(MONTH,IDAY,IHOUR),
     *RH(MONTH,IDAY,IHOUR),WV(MONTH,IDAY,IHOUR),CC(MONTH,IDAY) 
 1400 FORMAT(I2,5X,I2,4F7.1)
    5 CONTINUE
      CLOSE(100)
      CLOSE(200)
      CLOSE(300)
      STOP     
      END       